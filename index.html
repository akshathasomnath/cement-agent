<!DOCTYPE html>
<html>
<head>
  <title>Master Agent Cement Prediction</title>
  <style>
    body { font-family: Arial; margin: 40px; background: #f5f5f5; }
    h1 { color: #333; }
    label { display: block; margin-top: 10px; font-weight: bold; }
    input { padding: 5px; margin-top: 5px; width: 200px; }
    button { margin-top: 20px; padding: 10px 20px; font-size: 16px; cursor: pointer; }
    pre { background: #fff; padding: 20px; border-radius: 8px; margin-top: 20px; overflow-x: auto; }
    .card { background: #fff; padding: 15px; margin-top: 10px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    .summary { background: #e0f7fa; padding: 15px; margin-top: 10px; border-radius: 8px; font-weight: bold; }
  </style>
</head>
<body>

<h1>Master Agent Cement Prediction</h1>

<form id="agentForm">
  <label>Feed Rate:</label><input type="number" name="feed_rate" value="100" required>
  <label>Kiln Temperature:</label><input type="number" name="kiln_temp" value="1450" required>
  <label>Fuel Type:</label><input type="text" name="fuel_type" value="coal" required>
  <label>Power kWh/Ton:</label><input type="number" name="power_kwh_per_ton" value="90" required>
  <label>Fineness:</label><input type="number" name="fineness" value="3500" required>
  <label>Residue:</label><input type="number" name="residue" value="10" required>
  <label>Quality:</label><input type="number" name="quality" value="95" required>
  <button type="submit">Predict</button>
</form>

<div id="output"></div>

<script>
  const form = document.getElementById('agentForm');
  const outputDiv = document.getElementById('output');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const formData = new FormData(form);
    const inputData = {};
    formData.forEach((value, key) => inputData[key] = isNaN(value) ? value : Number(value));

    outputDiv.innerHTML = '<p>Loading predictions...</p>';

    try {
      const response = await fetch('https://adk-default-service-name-112091879413.us-central1.run.app', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ input: inputData })
      });

      const data = await response.json();

      if(data.error){
        outputDiv.innerHTML = `<pre style="color:red;">Error: ${data.error}</pre>`;
        return;
      }

      let html = '';
      html += `<div class="card"><strong>Input Parameters:</strong><pre>${JSON.stringify(data.input, null, 2)}</pre></div>`;
      html += `<div class="card"><strong>Agent Results:</strong><pre>${JSON.stringify(data.results, null, 2)}</pre></div>`;
      html += `<div class="summary">Overall Summary: ${data.overall_summary}</div>`;

      outputDiv.innerHTML = html;

    } catch (err) {
      outputDiv.innerHTML = `<pre style="color:red;">Fetch error: ${err}</pre>`;
    }
  });
</script>

</body>
</html>
